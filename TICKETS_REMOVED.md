# ‚úÖ –¢–∏–∫–µ—Ç—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ —Å–∏—Å—Ç–µ–º—ã

**–î–∞—Ç–∞:** 16 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∏–∫–µ—Ç—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–±–æ—Ç–µ, —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è

## üìù –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ö–µ–º–∞ Prisma
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `tickets` –∏–∑ `OpsMetrics`
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `sourceTkt` –∏–∑ `OpsMetrics`
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `trengoTickets` –∏–∑ `CountryAggregate`
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `trengoTickets` –∏–∑ `CountryUserInput`

### 2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
ALTER TABLE "ops_metrics" DROP COLUMN "tickets";
ALTER TABLE "ops_metrics" DROP COLUMN "sourceTkt";
ALTER TABLE "country_aggregates" DROP COLUMN "trengoTickets";
ALTER TABLE "country_user_inputs" DROP COLUMN "trengoTickets";
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–∏–ø—ã TypeScript
- ‚úÖ `src/types/api.ts` - —É–¥–∞–ª–µ–Ω—ã tickets –∏–∑ `OPSMetrics`, `CityAggregate`, `AnalyticsResponse`

### 4. –û–±–Ω–æ–≤–ª–µ–Ω—ã API endpoints
- ‚úÖ `/api/country-user-inputs` - —É–±—Ä–∞–Ω—ã trengoTickets
- ‚úÖ `/api/country-aggregates` - —É–±—Ä–∞–Ω—ã trengoTickets
- ‚úÖ `/api/export` - —É–±—Ä–∞–Ω—ã tickets –∏–∑ –≤—Å–µ—Ö CSV —ç–∫—Å–ø–æ—Ä—Ç–æ–≤
- ‚úÖ `/api/country-overview` - —É–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getTicketsValue`
- ‚úÖ `/api/ai-chat` - —É–±—Ä–∞–Ω—ã tickets –∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- ‚úÖ `/api/country-analytics` - —É–±—Ä–∞–Ω—ã totalTickets
- ‚úÖ `/api/analytics-data` - —É–±—Ä–∞–Ω—ã tickets –∏–∑ —Ä–∞—Å—á–µ—Ç–æ–≤
- ‚úÖ `/api/weekly-reports` - —É–±—Ä–∞–Ω—ã tickets –∏–∑ upsert
- ‚úÖ `/api/weekly-reports/[id]` - —É–±—Ä–∞–Ω—ã tickets –∏–∑ –æ—Ç–≤–µ—Ç–∞
- ‚úÖ `/api/debug/seed-test-data` - —É–±—Ä–∞–Ω—ã tickets –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### 5. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω Prisma Client
```bash
npx prisma generate
```

### 6. –£—Å–ø–µ—à–Ω–∞—è –∫–æ–º–ø–∏–ª—è—Ü–∏—è
```bash
npm run build - SUCCESS ‚úÖ
```

## üìä –¢–µ–∫—É—â–∏–µ OPS –º–µ—Ç—Ä–∏–∫–∏:

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ:
- ‚úÖ **messages** - –°–æ–æ–±—â–µ–Ω–∏—è (Trengo)
- ‚úÖ **orders** - –ó–∞–∫–∞–∑—ã –≥–æ—Ä–æ–¥–∞
- ‚úÖ **fullDays** - –û—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–Ω–∏
- ‚úÖ **diffCleaners** - –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –∫–ª–∏–Ω–µ—Ä–∞–º–∏
- ‚úÖ **diffClients** - –°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- ‚úÖ **stress** - –£—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–µ—Å—Å–∞ (0-10)
- ‚úÖ **overtime** - –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

## üîÑ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:
- **sourceMsg** - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è messages ('api'|'manual')
- **sourceOrd** - –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è orders ('api'|'manual')

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:
- –í—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –±–µ–∑ —Ç–∏–∫–µ—Ç–æ–≤
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ—á–∏—â–µ–Ω–∞ –æ—Ç –ø–æ–ª–µ–π tickets
- –í—Å–µ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ —Ç–∏–∫–µ—Ç–æ–≤
- –ö–æ–º–ø–∏–ª—è—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ Country Manager —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

