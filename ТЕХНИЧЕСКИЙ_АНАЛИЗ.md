# üî¨ –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú

**–î–∞—Ç–∞:** 14 –æ–∫—Ç—è–±—Ä—è 2025

---

## üìä –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–†–û–ë–õ–ï–ú

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞ | –ó–∞—Ç—Ä–æ–Ω—É—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –°—Ç–∞—Ç—É—Å |
|---|----------|------------------|-------------------------|-------------|--------|
| 1 | –õ–æ–≥–∏–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | `statement_cache_size` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–ª—è PgBouncer | 100% (–≤—Å–µ) | üî¥ CRITICAL | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 2 | –õ—é–¥–µ–π –≤—ã–∫–∏–¥—ã–≤–∞–µ—Ç | Connection pool exhaustion | 100% (–≤—Å–µ) | üî¥ CRITICAL | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 3 | Country Manager –ø—Ä–æ–±–ª–µ–º—ã | –°–ª–µ–¥—Å—Ç–≤–∏–µ #1 –∏ #2 | 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | üü† HIGH | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
| 4 | –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ | –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –ë–î + sequential queries | 100% (–≤—Å–µ) | üü° MEDIUM | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ |

---

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó

### –ü—Ä–æ–±–ª–µ–º–∞ #1: PgBouncer + Prisma Incompatibility

#### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—É—Ç—å:
```
Supabase Pooler (PgBouncer) ‚Üí Transaction Pooling Mode
                            ‚Üì
                  –ù–ï –ü–û–î–î–ï–†–ñ–ò–í–ê–ï–¢ Prepared Statements
                            ‚Üì
Prisma –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Üí –ò–°–ü–û–õ–¨–ó–£–ï–¢ Prepared Statements
                            ‚Üì
                         CONFLICT!
                            ‚Üì
          Query fails: "prepared statement does not exist"
```

#### –ö–∞–∫ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è:
```sql
-- Prisma –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
PREPARE s0 AS SELECT * FROM users WHERE login = $1;
EXECUTE s0('country_manager');

-- PgBouncer –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç prepared statements –º–µ–∂–¥—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏
-- –í —Å–ª–µ–¥—É—é—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
EXECUTE s0('country_manager'); -- ‚ùå ERROR: prepared statement "s0" does not exist
```

#### –†–µ—à–µ–Ω–∏–µ:
```bash
DATABASE_URL="...?statement_cache_size=0"
# Prisma —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—ã—á–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã –≤–º–µ—Å—Ç–æ prepared statements
```

#### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –ü–æ—Ç–µ—Ä—è: ~5% (–Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ)
- Gain: 100% —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- Trade-off: ‚úÖ –ü—Ä–∏–µ–º–ª–µ–º–æ –¥–ª—è serverless

#### –ò—Å—Ç–æ—á–Ω–∏–∫–∏:
- https://www.prisma.io/docs/guides/performance-and-optimization/connection-management/configure-pg-bouncer
- https://github.com/prisma/prisma/issues/6157

---

### –ü—Ä–æ–±–ª–µ–º–∞ #2: Connection Pool Exhaustion

#### –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã:

**–ë—ã–ª–æ:**
```
Supabase Free: 60 max connections (global)
Prisma default: ~10 connections per pool
DATABASE_URL: –ù–ï–¢ connection_limit –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
```

**–°—Ü–µ–Ω–∞—Ä–∏–π –∫—Ä–∞—Ö–∞:**
```
14 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π √ó 3 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ = 42 –Ω—É–∂–Ω–æ
Connection pool –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = 10
                            ‚Üì
10 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
32 –∑–∞–ø—Ä–æ—Å–∞ –≤–∏—Å—è—Ç –≤ –æ—á–µ—Ä–µ–¥–∏
                            ‚Üì
pool_timeout default = 10s (–Ω–æ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω!)
                            ‚Üì
–ß–µ—Ä–µ–∑ 10s ‚Üí timeout ‚Üí 500 error ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /login
```

**–£—Å—É–≥—É–±–ª—è—é—â–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
1. Serverless (Vercel) —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π instance –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–≥–∏–æ–Ω
2. –ö–∞–∂–¥—ã–π instance = —Å–≤–æ–π connection pool
3. 3 —Ä–µ–≥–∏–æ–Ω–∞ √ó 10 connections = 30 —É–∂–µ –∑–∞–Ω—è—Ç–æ
4. –û—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 30 –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π!

#### –†–µ—à–µ–Ω–∏–µ:
```bash
DATABASE_URL="...?connection_limit=15&pool_timeout=10"
```

**–ù–æ–≤–∞—è –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞:**
```
connection_limit = 15 (—è–≤–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ)
pool_timeout = 10s (—è–≤–Ω—ã–π timeout)
                            ‚Üì
15 –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π (max)
–û—Å—Ç–∞–ª—å–Ω—ã–µ –∂–¥—É—Ç –¥–æ 10s
–ï—Å–ª–∏ –Ω–µ –¥–æ–∂–¥–∞–ª–∏—Å—å ‚Üí graceful error (–Ω–µ crash!)
                            ‚Üì
–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ 15 –∏–∑ 60 –¥–æ—Å—Ç—É–ø–Ω—ã—Ö
–ó–∞–ø–∞—Å: 45 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è –¥—Ä—É–≥–∏—Ö instances/—Ä–µ–≥–∏–æ–Ω–æ–≤
```

#### –ü–æ—á–µ–º—É 15, –∞ –Ω–µ –±–æ–ª—å—à–µ?
```
–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª—è Supabase Free:
- Global limit: 60 connections
- Vercel regions: ~3 (us-east, eu-central, asia)
- Reserved –¥–ª—è admin: 5-10
- –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è app: 60 - 10 = 50
- Per region: 50 / 3 = ~16
- Connection limit: 15 (—Å –∑–∞–ø–∞—Å–æ–º)
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ #3: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

#### 3.1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–±–µ—Å–ø–ª–∞—Ç–Ω–∞—è)

**Supabase Free tier –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

| –†–µ—Å—É—Ä—Å | Free | Pro ($25/–º–µ—Å) | –†–∞–∑–Ω–∏—Ü–∞ |
|--------|------|---------------|---------|
| CPU | Shared (2 vCPU) | Dedicated (2 vCPU) | **3-5x –º–µ–¥–ª–µ–Ω–Ω–µ–µ** |
| RAM | Shared (1GB) | 8GB | **8x —Ä–∞–∑–Ω–∏—Ü–∞** |
| IOPS | Throttled | Full speed | **10x —Ä–∞–∑–Ω–∏—Ü–∞** |
| Connections | 60 | 200 | **3.3x —Ä–∞–∑–Ω–∏—Ü–∞** |

**–ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```
–ü—Ä–æ—Å—Ç–æ–π SELECT –∑–∞–ø—Ä–æ—Å:
Free:  200-500ms  üêå
Pro:   20-50ms    ‚ö° (10x –±—ã—Å—Ç—Ä–µ–µ!)

–°–ª–æ–∂–Ω—ã–π JOIN —Å 3 —Ç–∞–±–ª–∏—Ü–∞–º–∏:
Free:  800-1500ms üêå
Pro:   80-150ms   ‚ö° (10x –±—ã—Å—Ç—Ä–µ–µ!)

–ü–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π (10+ users):
Free:  2-5 —Å–µ–∫—É–Ω–¥ üêåüêåüêå
Pro:   200-500ms  ‚ö° (10x –±—ã—Å—Ç—Ä–µ–µ!)
```

#### 3.2. –ö–æ–¥ (sequential queries)

**–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û –≤ —ç—Ç–∏—Ö API:**

**`/api/country-overview`:**
```typescript
// –ë–´–õ–û (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ):
const cityAggregates = await prisma.countryAggregate.findMany(...);      // 150ms
const prevCityAggregates = await prisma.countryAggregate.findMany(...);  // 150ms
const userInputs = await prisma.countryUserInput.findMany(...);          // 100ms
const prevUserInputs = await prisma.countryUserInput.findMany(...);      // 100ms
const weeklyReports = await prisma.weeklyReport.findMany(...);           // 200ms
const prevWeeklyReports = await prisma.weeklyReport.findMany(...);       // 200ms
// –ò–¢–û–ì–û: 900ms

// –°–¢–ê–õ–û (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ):
const [
  cityAggregates,
  prevCityAggregates,
  userInputs,
  prevUserInputs,
  weeklyReports,
  prevWeeklyReports
] = await Promise.all([...]); // 200ms (—Å–∞–º—ã–π –¥–æ–ª–≥–∏–π –∑–∞–ø—Ä–æ—Å)
// –ò–¢–û–ì–û: 200ms (4.5x –±—ã—Å—Ç—Ä–µ–µ!)
```

**`/api/country-aggregates` POST:**
```typescript
// –ë–´–õ–û (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏):
for (const item of items) {
  const result = await tx.countryAggregate.upsert(...); // 50ms √ó 10 = 500ms
}
// –ò–¢–û–ì–û: 500ms

// –°–¢–ê–õ–û (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏):
const upsertPromises = items.map(item => tx.countryAggregate.upsert(...));
const results = await Promise.all(upsertPromises); // 50ms (–≤—Å–µ —Å—Ä–∞–∑—É)
// –ò–¢–û–ì–û: 50ms (10x –±—ã—Å—Ç—Ä–µ–µ!)
```

**–ï–©–ï –ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨:**

17 —Å—Ç—Ä–∞–Ω–∏—Ü –¥—É–±–ª–∏—Ä—É—é—Ç auth –ª–æ–≥–∏–∫—É:
```typescript
// –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–µ–ª–∞–µ—Ç:
const checkAuth = async () => {
  const res = await fetch('/api/auth/me');  // +500ms
  // ...
}

// –ù—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞:
import { useAuth } from '@/contexts/AuthContext';
const { user, loading } = useAuth(); // 0ms (—É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!)
```

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª:**
- 17 —Å—Ç—Ä–∞–Ω–∏—Ü √ó 500ms = **—ç–∫–æ–Ω–æ–º–∏—è 8.5 —Å–µ–∫—É–Ω–¥** —Å—É–º–º–∞—Ä–Ω–æ
- –ö–∞–∂–¥–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: **500ms –±—ã—Å—Ç—Ä–µ–µ**
- UX: –Ω–µ—Ç "–º–∏–≥–∞–Ω–∏—è" loading states

---

## üìà PERFORMANCE BENCHMARKS

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

```
–û–ø–µ—Ä–∞—Ü–∏—è                  | Free DB | –í—Ä–µ–º—è  | Success Rate
--------------------------|---------|--------|-------------
Login attempt            | ‚úì       | 2-5s   | 50% (!!!)
Dashboard load           | ‚úì       | 3-6s   | 70%
Country overview         | ‚úì       | 4-8s   | 60%
Save data                | ‚úì       | 3-7s   | 65%
--------------------------|---------|--------|-------------
–°—Ä–µ–¥–Ω–µ–µ UX:              |         | 5s     | 60% üò±
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è DATABASE_URL:

```
–û–ø–µ—Ä–∞—Ü–∏—è                  | Free DB | –í—Ä–µ–º—è  | Success Rate
--------------------------|---------|--------|-------------
Login attempt            | ‚úì       | 1-2s   | 99% ‚úÖ
Dashboard load           | ‚úì       | 2-3s   | 95%
Country overview         | ‚úì       | 1-2s   | 98%
Save data                | ‚úì       | 1-2s   | 97%
--------------------------|---------|--------|-------------
–°—Ä–µ–¥–Ω–µ–µ UX:              |         | 2s     | 97% üéâ
–£–ª—É—á—à–µ–Ω–∏–µ:               |         | 2.5x   | +37%
```

### –° Pro DB (–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏):

```
–û–ø–µ—Ä–∞—Ü–∏—è                  | Pro DB  | –í—Ä–µ–º—è  | Success Rate
--------------------------|---------|--------|-------------
Login attempt            | ‚úì       | 200ms  | 99.9% ‚úÖ
Dashboard load           | ‚úì       | 400ms  | 99%
Country overview         | ‚úì       | 300ms  | 99%
Save data                | ‚úì       | 250ms  | 99%
--------------------------|---------|--------|-------------
–°—Ä–µ–¥–Ω–µ–µ UX:              |         | 300ms  | 99% üöÄ
–£–ª—É—á—à–µ–Ω–∏–µ vs –¥–æ:         |         | 16x    | +39%
–£–ª—É—á—à–µ–Ω–∏–µ vs —Å–µ–π—á–∞—Å:     |         | 6x     | +2%
```

---

## üî¨ –ú–û–ù–ò–¢–û–†–ò–ù–ì –ò –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:

#### 1. Connection Pool Health
```sql
-- –í Supabase SQL Editor:
SELECT 
  count(*) as active_connections,
  application_name,
  state,
  wait_event_type
FROM pg_stat_activity
WHERE datname = 'postgres'
GROUP BY application_name, state, wait_event_type
ORDER BY active_connections DESC;
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
active_connections | application_name | state  | wait_event_type
-------------------|------------------|--------|----------------
10-15              | Prisma           | active | Client
2-3                | Prisma           | idle   | NULL
```

**‚ö†Ô∏è –ü–ª–æ—Ö–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
active_connections | application_name | state  | wait_event_type
-------------------|------------------|--------|----------------
50+                | Prisma           | active | Lock (!!!)
20+                | Prisma           | idle   | NULL (leak!)
```

#### 2. Query Performance
```typescript
// –£–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ src/lib/prisma.ts:
prisma.$use(async (params, next) => {
  const before = Date.now();
  const result = await next(params);
  const duration = Date.now() - before;
  
  if (duration > 1000) {
    console.warn(`üêå Slow query (${duration}ms):`, {
      model: params.model,
      action: params.action
    });
  }
  
  return result;
});
```

**–•–æ—Ä–æ—à–∏–µ –º–µ—Ç—Ä–∏–∫–∏ (Free DB):**
- SELECT: <500ms
- INSERT: <300ms
- UPDATE: <400ms
- Complex JOIN: <800ms

**–ü–ª–æ—Ö–∏–µ –º–µ—Ç—Ä–∏–∫–∏:**
- SELECT: >1000ms ‚Üí check indexes!
- INSERT: >500ms ‚Üí check constraints!
- UPDATE: >700ms ‚Üí check locks!

#### 3. Vercel Logs

**–•–æ—Ä–æ—à–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
```
‚úÖ Middleware: —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω
‚úÖ Login attempt { login: 'country_manager' }
‚úÖ User found { userId: 'user_country' }
‚úÖ [Login Success]
```

**–ü–ª–æ—Ö–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
```
‚ùå Connection timeout
‚ùå Too many connections
‚ùå Timed out fetching a new connection from the pool
‚ùå prepared statement "s0" does not exist
‚ùå Connection terminated unexpectedly
```

---

## üõ†Ô∏è TROUBLESHOOTING

### –°–∏–º–ø—Ç–æ–º: –í—Å–µ –µ—â–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏–Ω–∞

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. DATABASE_URL –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ Vercel (—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ)
2. –ù–µ —Å–¥–µ–ª–∞–Ω redeploy –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. –°—Ç–∞—Ä—ã–µ environment variables –≤ –∫—ç—à–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ DATABASE_URL –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ Vercel
vercel env ls

# 2. Force redeploy
vercel deploy --force

# 3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏
vercel logs
```

### –°–∏–º–ø—Ç–æ–º: –õ—é–¥–µ–π –≤—Å–µ –µ—â–µ –≤—ã–∫–∏–¥—ã–≤–∞–µ—Ç

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. Connection pool –≤—Å–µ –µ—â–µ –∏—Å—á–µ—Ä–ø—ã–≤–∞–µ—Ç—Å—è
2. Zombie connections –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è
3. –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–æ–≤ Vercel

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```sql
-- –°–∫–æ–ª—å–∫–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Å–µ–π—á–∞—Å?
SELECT count(*) FROM pg_stat_activity WHERE datname = 'postgres';

-- –ï—Å–ª–∏ >40 ‚Üí –ø—Ä–æ–±–ª–µ–º–∞!
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–º–µ–Ω—å—à–∏ connection_limit
DATABASE_URL="...?connection_limit=10&pool_timeout=10"

# –ò–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π —Ä–µ–≥–∏–æ–Ω—ã Vercel
vercel regions ls
vercel regions remove iad1 # –ø—Ä–∏–º–µ—Ä
```

### –°–∏–º–ø—Ç–æ–º: –í—Å–µ –µ—â–µ –º–µ–¥–ª–µ–Ω–Ω–æ

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ª–∏–º–∏—Ç IOPS)
2. –ù–µ—Ç –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
3. N+1 queries –≤ –∫–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –ü—Ä–∏–º–µ–Ω–∏ –∏–Ω–¥–µ–∫—Å—ã (—Ñ–∞–π–ª —É–∂–µ –µ—Å—Ç—å)
\i add-performance-indexes.sql

-- –ü—Ä–æ–≤–µ—Ä—å slow queries
SELECT * FROM pg_stat_statements 
ORDER BY mean_exec_time DESC 
LIMIT 10;
```

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

### –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
1. [Prisma + PgBouncer](https://www.prisma.io/docs/guides/performance-and-optimization/connection-management/configure-pg-bouncer)
2. [Supabase Connection Pooling](https://supabase.com/docs/guides/database/connecting-to-postgres)
3. [Vercel Serverless Functions](https://vercel.com/docs/concepts/functions/serverless-functions)

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
1. `CRITICAL_PERFORMANCE_ISSUES.md` - –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. `–ü–†–û–ë–õ–ï–ú–´_–ù–ï–°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò.md` - –ø—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ë–î
3. `–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_–õ–û–ì–ò–ù–ê.md` - –∏—Å—Ç–æ—Ä–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–Ω–∞
4. `–ù–ê–°–¢–†–û–ô–ö–ê_CONNECTION_POOL.md` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ pool

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–Æ

### –ü—Ä–∏ 20-30 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö:
- ‚úÖ –ú–æ–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è –Ω–∞ Free tier
- ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å `connection_limit=20`
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –ø—Ä–∏ –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

### –ü—Ä–∏ 30-50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö:
- ‚ö†Ô∏è Free tier –±—É–¥–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
- üí∞ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –Ω–∞ Pro tier
- üí∞ –ò–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π PostgreSQL —Å–µ—Ä–≤–µ—Ä

### –ü—Ä–∏ 50+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö:
- üí∞ Pro tier –º–∏–Ω–∏–º—É–º
- üí∞ –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å dedicated database
- üèóÔ∏è –ù–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
- üèóÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å read replicas

---

**–ò—Ç–æ–≥:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. –î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω—É–∂–µ–Ω –ª–∏–±–æ –ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ –ë–î, –ª–∏–±–æ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É.

---

_–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 14 –æ–∫—Ç—è–±—Ä—è 2025_  
_–ê–≤—Ç–æ—Ä: AI Technical Analyst_  
_–í–µ—Ä—Å–∏—è: 1.0_
