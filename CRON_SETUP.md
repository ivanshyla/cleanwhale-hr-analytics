# ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç AI-–æ—Ç—á–µ—Ç –¥–ª—è –ø—Ä–∞–≤–ª–µ–Ω–∏—è **–∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 12:00** (–ø–æ UTC).

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 1. Vercel Cron Job (`vercel.json`)

```json
{
  "crons": [
    {
      "path": "/api/cron/weekly-report",
      "schedule": "0 12 * * 1"
    }
  ]
}
```

**Schedule —Ñ–æ—Ä–º–∞—Ç:** `–º–∏–Ω—É—Ç–∞ —á–∞—Å –¥–µ–Ω—å –º–µ—Å—è—Ü –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏`
- `0 12 * * 1` = –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 12:00 UTC (15:00 –ø–æ –í–∞—Ä—à–∞–≤–µ)

### 2. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)

```env
CRON_SECRET=cleanwhale_cron_secret_2024_secure_key
TELEGRAM_BOT_TOKEN=7983513621:AAEhkYoAhpsgUD4A1GrZaqnZERKJBbyFs9Y
TELEGRAM_CHAT_ID=-834590892
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **Vercel** –≤—ã–∑—ã–≤–∞–µ—Ç endpoint `/api/cron/weekly-report` –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 12:00 UTC
2. **Endpoint** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (`CRON_SECRET`) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. **–°–∏—Å—Ç–µ–º–∞** –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø—Ä–æ—à–µ–¥—à—É—é –Ω–µ–¥–µ–ª—é –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
4. **OpenAI** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Å –∞–Ω–∞–ª–∏–∑–æ–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
5. **Telegram Bot** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á–µ—Ç –≤ —á–∞—Ç –ø—Ä–∞–≤–ª–µ–Ω–∏—è "CleanWhale Board"

## API Endpoint

`GET /api/cron/weekly-report`

### Headers
```
Authorization: Bearer ${CRON_SECRET}
```

### Response (success)
```json
{
  "success": true,
  "message": "Weekly report generated and sent",
  "weekIso": "2025-W39",
  "sentToTelegram": true,
  "reportLength": 1400,
  "timestamp": "2025-10-08T09:07:44.486Z"
}
```

### Response (no data)
```json
{
  "success": true,
  "message": "No data available, notification sent",
  "weekIso": "2025-W39"
}
```

–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram.

### Response (error)
```json
{
  "success": false,
  "error": "error message"
}
```

–ü—Ä–∏ –æ—à–∏–±–∫–µ —Å–∏—Å—Ç–µ–º–∞ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ Telegram.

## –§–æ—Ä–º–∞—Ç –æ—Ç—á–µ—Ç–∞

–û—Ç—á–µ—Ç –≤–∫–ª—é—á–∞–µ—Ç:

1. **Executive Summary** - –∫—Ä–∞—Ç–∫–∏–µ –≤—ã–≤–æ–¥—ã –¥–ª—è –ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. **–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏** —Å –¥–∏–Ω–∞–º–∏–∫–æ–π (‚Üë‚Üì%) –∑–∞ 4 –Ω–µ–¥–µ–ª–∏
3. **–ê–Ω–∞–ª–∏–∑ –ø–æ –≥–æ—Ä–æ–¥–∞–º** - –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ –ª–æ–∫–∞—Ü–∏—è–º
4. **–ê–Ω–∞–ª–∏–∑ –ø–æ —Ç–∏–ø–∞–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤** - HR vs Ops vs Mixed
5. **–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∑–æ–Ω—ã** - —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è
6. **–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è** - —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ
7. **–ü—Ä–æ–≥–Ω–æ–∑** - –æ–∂–∏–¥–∞–Ω–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é –Ω–µ–¥–µ–ª—é

## –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

–í—ã –º–æ–∂–µ—Ç–µ –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å—Ç–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –æ—Ç—á–µ—Ç–∞ —á–µ—Ä–µ–∑ API:

```bash
curl -X GET https://your-domain.vercel.app/api/cron/weekly-report \
  -H "Authorization: Bearer ${CRON_SECRET}"
```

–ò–ª–∏ —á–µ—Ä–µ–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—É Analytics:
1. –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ `country_manager` –∏–ª–∏ `admin`
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É **"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞"**
3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üß† AI –û—Ç—á–µ—Ç –¥–ª—è –ø—Ä–∞–≤–ª–µ–Ω–∏—è"**

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Endpoint –∑–∞—â–∏—â–µ–Ω —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º `CRON_SECRET`
- ‚úÖ –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç Cron
- ‚úÖ –¢–æ–∫–µ–Ω Telegram Bot –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Vercel Dashboard
- –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: https://vercel.com/your-project/logs
- –°—Ç–∞—Ç—É—Å Cron Jobs: https://vercel.com/your-project/crons

### Telegram
- –û—Ç—á–µ—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ —á–∞—Ç "CleanWhale Board"
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø—Ä–∏—Ö–æ–¥—è—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `vercel.json`:

```json
{
  "crons": [
    {
      "path": "/api/cron/weekly-report",
      "schedule": "0 14 * * 1"  // –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 14:00 UTC (17:00 –í–∞—Ä—à–∞–≤–∞)
    }
  ]
}
```

**–ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:**
- `0 9 * * 1` - –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 09:00 UTC (12:00 –í–∞—Ä—à–∞–≤–∞)
- `0 12 * * 1` - –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 12:00 UTC (15:00 –í–∞—Ä—à–∞–≤–∞) ‚¨ÖÔ∏è **–¢–ï–ö–£–©–ï–ï**
- `0 15 * * 1` - –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 15:00 UTC (18:00 –í–∞—Ä—à–∞–≤–∞)
- `0 12 * * 5` - –ü—è—Ç–Ω–∏—Ü–∞ –≤ 12:00 UTC

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∑–∞–¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞ Vercel: `git push origin main`

## –§–∞–π–ª—ã

- **`/src/app/api/cron/weekly-report/route.ts`** - Cron endpoint
- **`/src/lib/telegram.ts`** - Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- **`/vercel.json`** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vercel Cron
- **`.env`** - –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ (–Ω–µ –≤ Git)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

‚úÖ **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:** 08.10.2025
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞: ‚úÖ
- –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram: ‚úÖ
- –§–æ—Ä–º–∞—Ç Markdown: ‚úÖ
- –ö–∏—Ä–∏–ª–ª–∏—Ü–∞: ‚úÖ

**–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:**
```json
{
  "success": true,
  "weekIso": "2025-W39",
  "sentToTelegram": true,
  "reportLength": 1400
}
```

–û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –≤ —á–∞—Ç "CleanWhale Board".

## Troubleshooting

### –û—Ç—á–µ—Ç –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ Vercel Dashboard
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `CRON_SECRET` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Vercel Environment Variables
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Telegram credentials –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

### –û—Ç—á–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø—É—Å—Ç–æ–π
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω—É–∂–Ω–æ–π –Ω–µ–¥–µ–ª–∏
3. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

### –û—à–∏–±–∫–∞ OpenAI
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `OPENAI_API_KEY` –Ω–∞—Å—Ç—Ä–æ–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API –Ω–∞ https://platform.openai.com/usage
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –∞–∫–∫–∞—É–Ω—Ç–∞ OpenAI

---

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç! üéâ**

–ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 15:00 (–ø–æ –í–∞—Ä—à–∞–≤–µ) –ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π AI-–æ—Ç—á–µ—Ç —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∑–∞ –ø—Ä–æ—à–µ–¥—à—É—é –Ω–µ–¥–µ–ª—é.

