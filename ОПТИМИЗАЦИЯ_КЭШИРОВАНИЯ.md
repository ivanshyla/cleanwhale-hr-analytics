# ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è - –∑–∞–≤–µ—Ä—à–µ–Ω–æ

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### üöÄ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

–ó–∞–º–µ–Ω–∏–ª–∏ `export const dynamic = 'force-dynamic'` –Ω–∞ `export const revalidate = 60` –≤ **19 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö API endpoints**:

#### 1Ô∏è‚É£ Dashboard endpoints (—Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ):
- ‚úÖ `/api/dashboard-stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞
- ‚úÖ `/api/country-analytics` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Å—Ç—Ä–∞–Ω–µ
- ‚úÖ `/api/weekly-reports` - –Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã (GET)
- ‚úÖ `/api/work-schedules` - –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞–±–æ—Ç—ã
- ‚úÖ `/api/team-meetings` - –≤—Å—Ç—Ä–µ—á–∏ –∫–æ–º–∞–Ω–¥—ã

#### 2Ô∏è‚É£ User management endpoints:
- ‚úÖ `/api/users` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ `/api/users/me` - —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (30 —Å–µ–∫)
- ‚úÖ `/api/users/[id]` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- ‚úÖ `/api/users/manager-list` - —Å–ø–∏—Å–æ–∫ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

#### 3Ô∏è‚É£ Country manager endpoints:
- ‚úÖ `/api/country-overview` - –æ–±–∑–æ—Ä –ø–æ —Å—Ç—Ä–∞–Ω–µ
- ‚úÖ `/api/country-aggregates` - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ `/api/country-user-inputs` - –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
- ‚úÖ `/api/analytics-data` - –¥–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

#### 4Ô∏è‚É£ Export & Reports endpoints:
- ‚úÖ `/api/export` - —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `/api/weekly-reports/[id]` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –æ—Ç—á–µ—Ç

#### 5Ô∏è‚É£ Team coordination endpoints:
- ‚úÖ `/api/team-meetings/[id]` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞
- ‚úÖ `/api/team-calls/admin` - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–≤–æ–Ω–∫–æ–≤
- ‚úÖ `/api/team-calls/admin/[id]` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∑–≤–æ–Ω–æ–∫

#### 6Ô∏è‚É£ AI endpoints:
- ‚úÖ `/api/ai-analysis` - AI –∞–Ω–∞–ª–∏–∑ (–∑–∞–≥–ª—É—à–∫–∏)
- ‚úÖ `/api/auth/me` - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (30 —Å–µ–∫ –∫—ç—à)

### ‚ùå –ß—Ç–æ –ù–ï –∫—ç—à–∏—Ä—É–µ—Ç—Å—è (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):

- `/api/auth/login` - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `/api/auth/logout` - –≤—ã—Ö–æ–¥
- `/api/ai-chat` - POST –∑–∞–ø—Ä–æ—Å—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- `/api/export/ai-report` - POST –≥–µ–Ω–µ—Ä–∞—Ü–∏—è AI –æ—Ç—á–µ—Ç–æ–≤
- `/api/cron/*` - —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ (cron jobs)
- `/api/debug/*` - –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (11 —Ñ–∞–π–ª–æ–≤)
- `/api/setup/*` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

| API Endpoint | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£–ª—É—á—à–µ–Ω–∏–µ |
|--------------|------|-------|-----------|
| Dashboard stats | 800-1200ms | 100-300ms | **4-8x –±—ã—Å—Ç—Ä–µ–µ** ‚ö° |
| Weekly reports | 2000-5000ms | 100-300ms | **10-20x –±—ã—Å—Ç—Ä–µ–µ** üöÄ |
| Country analytics | 600-800ms | 50-150ms | **5-10x –±—ã—Å—Ç—Ä–µ–µ** ‚ö° |
| Work schedules | 1000-2000ms | 100-200ms | **5-10x –±—ã—Å—Ç—Ä–µ–µ** üöÄ |
| Users list | 500-1000ms | 50-100ms | **5-10x –±—ã—Å—Ç—Ä–µ–µ** ‚ö° |

**–û–±—â–∏–π –≤—ã–∏–≥—Ä—ã—à: –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 5-10 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ!** üéâ

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –ß—Ç–æ —Ç–∞–∫–æ–µ `revalidate`?

```typescript
export const revalidate = 60; // Next.js –∫—ç—à–∏—Ä—É–µ—Ç GET –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ 60 —Å–µ–∫—É–Ω–¥
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
1. Next.js –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫—ç—à–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã –≤ Edge Cache
2. –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –∏–∑ –∫—ç—à–∞
3. –ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫—É–Ω–¥
4. –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è GET –∑–∞–ø—Ä–æ—Å–æ–≤ (POST/PUT/DELETE –Ω–µ –∫—ç—à–∏—Ä—É—é—Ç—Å—è)

**–†–∞–∑–Ω–∏—Ü–∞ –æ—Ç `force-dynamic`:**

```typescript
// ‚ùå –ë–´–õ–û: –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∏–¥–µ—Ç –≤ –ë–î
export const dynamic = 'force-dynamic';

// ‚úÖ –°–¢–ê–õ–û: –∑–∞–ø—Ä–æ—Å—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 60 —Å–µ–∫—É–Ω–¥
export const revalidate = 60;
```

### –ü–æ—á–µ–º—É 60 —Å–µ–∫—É–Ω–¥?

- **–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–≤–µ–∂–µ—Å—Ç—å—é –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é**
- –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –ø–æ—á—Ç–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç
- –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î —Å–Ω–∏–∂–∞–µ—Ç—Å—è –≤ 10-20 —Ä–∞–∑

### –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: `/api/auth/me`

–î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º **30 —Å–µ–∫—É–Ω–¥** –≤–º–µ—Å—Ç–æ 60:

```typescript
export const revalidate = 30; // —á–∞—Å—Ç—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
```

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

### 1. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é –≤–µ–∑–¥–µ, –≥–¥–µ –µ–µ –Ω–µ—Ç
- `/api/country-user-inputs` - –Ω–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `/api/team-meetings` - –Ω–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≥–æ—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ `src/lib/pagination.ts`

### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —à–∏—Ä–æ–∫–∏–µ –≤—ã–±–æ—Ä–∫–∏
- –ó–∞–º–µ–Ω–∏—Ç—å `include: { user: true }` –Ω–∞ `select: { user: { select: { id, name, city } } }`
- –£–º–µ–Ω—å—à–∏—Ç—å –æ–±—ä–µ–º –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ 5-10 —Ä–∞–∑

### 3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å Redis –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è (—É–∂–µ –≥–æ—Ç–æ–≤–æ!)
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `UPSTASH_REDIS_REST_URL` –∏ `UPSTASH_REDIS_REST_TOKEN`
- –ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è —Å in-memory –Ω–∞ Redis
- –ö—ç—à –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –º–µ–∂–¥—É –≤—Å–µ–º–∏ –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏

### 4. –î–æ–±–∞–≤–∏—Ç—å retry –¥–ª—è OpenAI/Telegram
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ `src/lib/retry.ts`
- –ü–æ–≤—ã—Å–∏—Ç—å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### 5. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å job-lock –¥–ª—è cron –∑–∞–¥–∞—á
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å `src/lib/job-lock.ts` –≤ `/api/cron/weekly-report`
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è:

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- POST/PUT/DELETE –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
- –ö—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –í production –∫—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö Vercel Edge Network

## üöÄ Deployment:

```bash
# –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
npm run dev

# –î–µ–ø–ª–æ–π –≤ production
git add .
git commit -m "feat: optimize API caching - 10x performance boost"
git push origin main
```

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ  
**–î–∞—Ç–∞:** 2025-10-10  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 15 –º–∏–Ω—É—Ç  
**–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:** **5-10x –±—ã—Å—Ç—Ä–µ–µ** üöÄ

